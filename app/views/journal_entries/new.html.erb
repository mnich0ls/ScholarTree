<%= content_for :head do %>
    <script type="text/javascript">
        $(document).ready(function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position){
                    // should use a spinner or some indicator to show that location is being determined.
                    var lat = $('<input>')
                            .attr("type", "hidden")
                            .attr("name", "journal_entry[latitude]")
                            .val(position.coords.latitude);
                    var lon = $('<input>')
                            .attr("type", "hidden")
                            .attr("name", "journal_entry[longitude]")
                            .val(position.coords.longitude);
                    $('.journal_entry_form').append($(lon));
                    $('.journal_entry_form').append($(lat));
                });
            }
        });
    </script>
<% end %>

<%= form_for @journal_entry, url: {action: 'create'}, html: {class:'journal_entry_form'} do |f| %>
    <fieldset>
      <legend>New Journal Entry</legend>

      <div class="control-group">
        <%= f.label :journal, class: 'control-label' %>
        <div class="condtrols">
          <%= f.select(:journal_id, options_from_collection_for_select(@journals, :id, :name)) %>
        </div>
      </div>
      <div class="control-group">
        <%= f.label :description, class: 'control-label' %>
        <div class="controls">
          <%= f.text_field :description %>
        </div>
      </div>

      <div class="control-group">
        <%= f.label :entry, class: 'control-label' %>
        <div class="controls">
          <%= f.text_area :entry, :style => 'width: 100%; height: 400px;' %>
        </div>
      </div>

      <div class="form-actions">
        <%= f.submit 'Save', :class => 'btn btn-success' %>
      </div>
    </fieldset>
<% end %>